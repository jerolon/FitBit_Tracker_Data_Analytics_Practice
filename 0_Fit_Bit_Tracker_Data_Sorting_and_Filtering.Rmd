---
title: "0_Fit_Bit_Tracker_Data_Sorting_and_Filtering"
author: "Jeronimo Miranda"
date: '2023-05-05'
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(skimr)
library(dplyr)
```

```{r directory setup, include = FALSE}
rstudioapi::getActiveDocumentContext
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
```

## Loading and exploring the data
We are using the data from <https://www.kaggle.com/datasets/arashnic/fitbit>. 
Assume the path to the data is in a folder above where the repository is.
### Daily activity data
```{r data loading}
data_path <- "../Fitabase Data 4.12.16-5.12.16/"
dailyActivity <- read_csv(paste0(data_path,"dailyActivity_merged.csv"), 
    col_types = cols(Id = col_character(), 
        ActivityDate = col_date(format = "%m/%d/%Y")))
skim_without_charts(dailyActivity)
```

Loaded the dates in the correct format. Since apart from date and Id all columns are numeric, it makes sense to use skim_without_charts which gives a statistical summary of each variable. The function output is rendered as an html table, which is quite nice. What we can see from this summary:
  * Data was collected for 31 days.
  * 33 unique Ids, all have 10 characters.
  * The minimum for **all** numeric variables is 0. This suggests empty days, maybe just days that people did not wear their devices. These rows should be eliminated.
  * Column names do not need to be cleaned
  * The data is in long format
  * This data can help answer our question by telling us how frequently people track different activities. Before any analysis we can see that most activity is done via trackerDistance rather than LoggedActivities

Total distance is not the sum of TrackerDistance and LoggedActivitiesDistance, as one could assume. Rather it seems to be the sum of the ActiveDistances columns. Lack of metadata is killing me here.
```{r sum of distances}
filter(dailyActivity, TotalDistance != (LoggedActivitiesDistance + TrackerDistance))
```
### Number of days tracked
We group the days by Id and then plot a histogram of how many days people in the dataset were tracked
```{r number of days tracked, echo=FALSE}
library(ggplot2)
select(dailyActivity, Id, ActivityDate) %>% group_by(Id) %>% summarise(N_days = n()) %>% ggplot() + geom_histogram(aes(x = N_days)) + theme_bw()
```
Running `select(dailyActivity, Id, ActivityDate) %>% distinct()` shows that there are no duplicate dates for any Id

